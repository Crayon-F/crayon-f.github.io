<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>1.MVVM的理解 | 蜡笔-小新</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
    <meta name="description" content="前端*前端">
    
    <link rel="preload" href="/assets/css/0.styles.59073369.css" as="style"><link rel="preload" href="/assets/js/app.ae35c946.js" as="script"><link rel="preload" href="/assets/js/4.7a9925ca.js" as="script"><link rel="preload" href="/assets/js/7.7df142e3.js" as="script"><link rel="prefetch" href="/assets/js/1.a85f77d0.js"><link rel="prefetch" href="/assets/js/10.4437fbd9.js"><link rel="prefetch" href="/assets/js/11.fc0caee6.js"><link rel="prefetch" href="/assets/js/12.9ae12081.js"><link rel="prefetch" href="/assets/js/13.a236975b.js"><link rel="prefetch" href="/assets/js/14.c970eefa.js"><link rel="prefetch" href="/assets/js/15.6ed1e1eb.js"><link rel="prefetch" href="/assets/js/16.da7bd798.js"><link rel="prefetch" href="/assets/js/17.ff8b8b21.js"><link rel="prefetch" href="/assets/js/18.daac6fd8.js"><link rel="prefetch" href="/assets/js/19.924e0828.js"><link rel="prefetch" href="/assets/js/20.e3a628d6.js"><link rel="prefetch" href="/assets/js/21.32f56551.js"><link rel="prefetch" href="/assets/js/22.6840f6f6.js"><link rel="prefetch" href="/assets/js/23.179fd3a2.js"><link rel="prefetch" href="/assets/js/24.051dea42.js"><link rel="prefetch" href="/assets/js/25.afb1d0c6.js"><link rel="prefetch" href="/assets/js/26.32d8d928.js"><link rel="prefetch" href="/assets/js/27.65e36429.js"><link rel="prefetch" href="/assets/js/28.2f4d7c6a.js"><link rel="prefetch" href="/assets/js/29.7b243c60.js"><link rel="prefetch" href="/assets/js/3.3a4b3e43.js"><link rel="prefetch" href="/assets/js/30.200349ab.js"><link rel="prefetch" href="/assets/js/31.0169f5d4.js"><link rel="prefetch" href="/assets/js/32.d7801ef7.js"><link rel="prefetch" href="/assets/js/33.998f2e93.js"><link rel="prefetch" href="/assets/js/34.25baceac.js"><link rel="prefetch" href="/assets/js/35.90337bb9.js"><link rel="prefetch" href="/assets/js/36.38257457.js"><link rel="prefetch" href="/assets/js/37.81238058.js"><link rel="prefetch" href="/assets/js/38.2d537690.js"><link rel="prefetch" href="/assets/js/39.81a6596a.js"><link rel="prefetch" href="/assets/js/40.d1a1ad8c.js"><link rel="prefetch" href="/assets/js/41.250ffa61.js"><link rel="prefetch" href="/assets/js/42.8d208f71.js"><link rel="prefetch" href="/assets/js/43.5cf73da3.js"><link rel="prefetch" href="/assets/js/5.91ba935f.js"><link rel="prefetch" href="/assets/js/6.59f2c097.js"><link rel="prefetch" href="/assets/js/8.c680a939.js"><link rel="prefetch" href="/assets/js/9.19cdaf0c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.59073369.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">蜡笔-小新</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/interview/javascript/common.html" class="nav-link">
  JavaScript
</a></div><div class="nav-item"><a href="/cleanheart/miscellaneous/sentence.html" class="nav-link">
  杂六
</a></div><div class="nav-item"><a href="https://github.com/Crayon-F" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/interview/javascript/common.html" class="nav-link">
  JavaScript
</a></div><div class="nav-item"><a href="/cleanheart/miscellaneous/sentence.html" class="nav-link">
  杂六
</a></div><div class="nav-item"><a href="https://github.com/Crayon-F" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>webpack</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>vue</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/interview/vue/init.html" aria-current="page" class="active sidebar-link">基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/interview/vue/init.html#_1-mvvm的理解" class="sidebar-link">1.MVVM的理解</a></li><li class="sidebar-sub-header"><a href="/interview/vue/init.html#_2-vue理解" class="sidebar-link">2.Vue理解</a></li><li class="sidebar-sub-header"><a href="/interview/vue/init.html#_3-响应式数据原理" class="sidebar-link">3.响应式数据原理</a></li><li class="sidebar-sub-header"><a href="/interview/vue/init.html#_4-vue中是如何检测数组变化" class="sidebar-link">4.Vue中是如何检测数组变化?</a></li><li class="sidebar-sub-header"><a href="/interview/vue/init.html#_5-computed的特点" class="sidebar-link">5.computed的特点</a></li><li class="sidebar-sub-header"><a href="/interview/vue/init.html#_6-computed和methods和watcher区别" class="sidebar-link">6.computed和methods和watcher区别</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/interview/vue/init.html#computed" class="sidebar-link">computed</a></li><li class="sidebar-sub-header"><a href="/interview/vue/init.html#methods" class="sidebar-link">methods：</a></li><li class="sidebar-sub-header"><a href="/interview/vue/init.html#watcher-一方改变-另一方跟着改变" class="sidebar-link">watcher(一方改变，另一方跟着改变)</a></li></ul></li><li class="sidebar-sub-header"><a href="/interview/vue/init.html#_7-生命周期" class="sidebar-link">7.生命周期</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/interview/vue/init.html#每个生命周期的用途" class="sidebar-link">每个生命周期的用途</a></li><li class="sidebar-sub-header"><a href="/interview/vue/init.html#每个声明周期需要做的的事情" class="sidebar-link">每个声明周期需要做的的事情</a></li></ul></li><li class="sidebar-sub-header"><a href="/interview/vue/init.html#_8-v-show和v-if的区别" class="sidebar-link">8.v-show和v-if的区别</a></li><li class="sidebar-sub-header"><a href="/interview/vue/init.html#_9-v-for和v-if" class="sidebar-link">9.v-for和v-if</a></li><li class="sidebar-sub-header"><a href="/interview/vue/init.html#_10-组件中的-data为什么是一个函数" class="sidebar-link">10.组件中的 data为什么是一个函数?</a></li><li class="sidebar-sub-header"><a href="/interview/vue/init.html#_11-vue组件如何通信" class="sidebar-link">11.Vue组件如何通信?</a></li><li class="sidebar-sub-header"><a href="/interview/vue/init.html#_12-vue中常见性能优化" class="sidebar-link">12.Vue中常见性能优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/interview/vue/init.html#_1-编码优化" class="sidebar-link">1.编码优化</a></li><li class="sidebar-sub-header"><a href="/interview/vue/init.html#_2-vue加载性能优化" class="sidebar-link">2.Vue加载性能优化:</a></li><li class="sidebar-sub-header"><a href="/interview/vue/init.html#_3-用户体验" class="sidebar-link">3.用户体验</a></li><li class="sidebar-sub-header"><a href="/interview/vue/init.html#_4-seo优化" class="sidebar-link">4.SEO优化：</a></li><li class="sidebar-sub-header"><a href="/interview/vue/init.html#_5-打包优化" class="sidebar-link">5.打包优化:</a></li><li class="sidebar-sub-header"><a href="/interview/vue/init.html#_6-缓存-压缩" class="sidebar-link">6.缓存，压缩</a></li></ul></li><li class="sidebar-sub-header"><a href="/interview/vue/init.html#_13-vue3-0你知道有哪些改进" class="sidebar-link">13.Vue3.0你知道有哪些改进?</a></li><li class="sidebar-sub-header"><a href="/interview/vue/init.html#_14-router和route的区别" class="sidebar-link">14.$router和route的区别</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/interview/vue/init.html#以history对象来举例" class="sidebar-link">以history对象来举例：</a></li><li class="sidebar-sub-header"><a href="/interview/vue/init.html#这两者不同的结构可以看出两者的区别-他们的一些属性是不同的。" class="sidebar-link">这两者不同的结构可以看出两者的区别，他们的一些属性是不同的。</a></li></ul></li><li class="sidebar-sub-header"><a href="/interview/vue/init.html#_15-vue-use-执行原理" class="sidebar-link">15.Vue.use()执行原理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/interview/vue/init.html#vue-use-是通过inituse进行初始化" class="sidebar-link">Vue.use()是通过initUse进行初始化</a></li></ul></li><li class="sidebar-sub-header"><a href="/interview/vue/init.html#_16-vue中key值的作用" class="sidebar-link">16.Vue中key值的作用</a></li></ul></li><li><a href="/interview/vue/library.html" class="sidebar-link">组件</a></li><li><a href="/interview/vue/vuex.html" class="sidebar-link">Vuex</a></li><li><a href="/interview/vue/render.html" class="sidebar-link">render</a></li><li><a href="/interview/vue/commonTable.html" class="sidebar-link">elementUi搭配vue封装table组件</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Blockchain</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="_1-mvvm的理解"><a href="#_1-mvvm的理解" class="header-anchor">#</a> 1.MVVM的理解</h2> <ul><li>MVC</li></ul> <p>model+view+controller 用户操作会请求服务端路由，路由会调用对应的控制器来处理,控制器会获取数据。将结果返回给前端,页面重新渲染</p> <ul><li>MVVM</li></ul> <p>mode+view+viewmode 传统的前端会将数据手动渲染到页面上,<code>MVVM</code>模式不需要用户收到操作<code>dom</code>元素,将数据绑定到<code>viewModel</code>层上，会自动将数据渲染到页面中，视图变化会通知<code>viewModel层</code>更新数据。<code>ViewModel</code>就是我们<code>MVVM</code>模式中的桥梁.</p> <h2 id="_2-vue理解"><a href="#_2-vue理解" class="header-anchor">#</a> 2.Vue理解</h2> <ul><li>vue</li></ul> <p>渐进性框架，是一种自底而上的增量开发设计
渐进性<br>
在声明式渲染(模板视图渲染)的基础上,可以通过增加组件系统(components),理由(vue-router),状态管理(vuex)来构建一个完整的框架<br>
声明式渲染和组件库是Vue的核心内容,而数据状态管理,路由,构架工具都有专门的独立方案解决<br>
'渐进式'是vue的提现方式，也是他的设计理念</p> <h2 id="_3-响应式数据原理"><a href="#_3-响应式数据原理" class="header-anchor">#</a> 3.响应式数据原理</h2> <ol><li>调用new observer的defaultReact通过递归给对象的每一个属性添加Object.defineProperty,并创建dep实例保存相关依赖</li> <li>Dep实例保存一个sub数组，保存的依赖添加到数组中，更新依赖调用数组中的update方法</li> <li>依赖是一时watch实例，保存了数据变化时需要更新的操作，并且将自己放入全局中，读取数据时，触发数据的get，将自身收集到dep数组中</li></ol> <br> <br> <img src="/assets/img/object.c555711a.png"> <div class="language-js line-numbers-mode"><pre class="language-js"><code>Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    enumerable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    configurable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">reactiveGetter</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> value <span class="token operator">=</span> getter <span class="token operator">?</span> <span class="token function">getter</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">:</span> val
      <span class="token keyword">if</span> <span class="token punctuation">(</span>Dep<span class="token punctuation">.</span>target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        dep<span class="token punctuation">.</span><span class="token function">depend</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// ** 收集依赖 ** /</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>childOb<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          childOb<span class="token punctuation">.</span>dep<span class="token punctuation">.</span><span class="token function">depend</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">dependArray</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> value
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">reactiveSetter</span> <span class="token punctuation">(</span><span class="token parameter">newVal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> value <span class="token operator">=</span> getter <span class="token operator">?</span> <span class="token function">getter</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">:</span> val
      <span class="token keyword">if</span> <span class="token punctuation">(</span>newVal <span class="token operator">===</span> value <span class="token operator">||</span> <span class="token punctuation">(</span>newVal <span class="token operator">!==</span> newVal <span class="token operator">&amp;&amp;</span> value <span class="token operator">!==</span> value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">'production'</span> <span class="token operator">&amp;&amp;</span> customSetter<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">customSetter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      val <span class="token operator">=</span> newVal
      childOb <span class="token operator">=</span> <span class="token operator">!</span>shallow <span class="token operator">&amp;&amp;</span> <span class="token function">observe</span><span class="token punctuation">(</span>newVal<span class="token punctuation">)</span>
      dep<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">/**通知相关依赖进行更新**/</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h2 id="_4-vue中是如何检测数组变化"><a href="#_4-vue中是如何检测数组变化" class="header-anchor">#</a> 4.Vue中是如何检测数组变化?</h2> <div class="custom-block tip"><p class="custom-block-title">Vue中是如何检测数组变化?</p> <ol><li>使用函数劫持的方式，重写了数组的方法</li> <li><code>Vue</code>将<code>data</code>中的数组，进行了原型链重写。指向了自己定义的数组原型方法，这样当调用数组<code>api</code>时，可以通知依赖更新.如果数组中包含着引用类型。会对数组中的引用类型再次进行监控。</li></ol></div> <br> <br> <img src="/assets/img/array.f211a2f9.png"> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> arrayProto <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype
<span class="token keyword">export</span> <span class="token keyword">const</span> arrayMethods <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>arrayProto<span class="token punctuation">)</span>
<span class="token keyword">const</span> methodsToPatch <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token string">'push'</span><span class="token punctuation">,</span>
  <span class="token string">'pop'</span><span class="token punctuation">,</span>
  <span class="token string">'shift'</span><span class="token punctuation">,</span>
  <span class="token string">'unshift'</span><span class="token punctuation">,</span>
  <span class="token string">'splice'</span><span class="token punctuation">,</span>
  <span class="token string">'sort'</span><span class="token punctuation">,</span>
  <span class="token string">'reverse'</span>
<span class="token punctuation">]</span>
methodsToPatch<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">method</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 重写原型方法</span>
  <span class="token keyword">const</span> original <span class="token operator">=</span> arrayProto<span class="token punctuation">[</span>method<span class="token punctuation">]</span> <span class="token comment">// 调用原数组的方法</span>
  <span class="token function">def</span><span class="token punctuation">(</span>arrayMethods<span class="token punctuation">,</span> method<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token function">mutator</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">original</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span>
    <span class="token keyword">const</span> ob <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>__ob__
    <span class="token keyword">let</span> inserted
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>method<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> <span class="token string">'push'</span><span class="token operator">:</span>
      <span class="token keyword">case</span> <span class="token string">'unshift'</span><span class="token operator">:</span>
        inserted <span class="token operator">=</span> args
        <span class="token keyword">break</span>
      <span class="token keyword">case</span> <span class="token string">'splice'</span><span class="token operator">:</span>
        inserted <span class="token operator">=</span> args<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
        <span class="token keyword">break</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>inserted<span class="token punctuation">)</span> ob<span class="token punctuation">.</span><span class="token function">observeArray</span><span class="token punctuation">(</span>inserted<span class="token punctuation">)</span>
    <span class="token comment">// notify change</span>
    ob<span class="token punctuation">.</span>dep<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 当调用数组方法后，手动通知视图更新</span>
    <span class="token keyword">return</span> result
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">observeArray</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token comment">// 进行深度监控</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><h2 id="_5-computed的特点"><a href="#_5-computed的特点" class="header-anchor">#</a> 5.computed的特点</h2> <ul><li>1.会有缓存，当依赖发生变化时，采取更新视图
<br> <img src="/assets/img/computed.c4b5a221.png"> <br></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">initComputed</span> <span class="token punctuation">(</span><span class="token parameter">vm<span class="token operator">:</span> Component<span class="token punctuation">,</span> computed<span class="token operator">:</span> Object</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> watchers <span class="token operator">=</span> vm<span class="token punctuation">.</span>_computedWatchers <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> isSSR <span class="token operator">=</span> <span class="token function">isServerRendering</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> computed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> userDef <span class="token operator">=</span> computed<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
    <span class="token keyword">const</span> getter <span class="token operator">=</span> <span class="token keyword">typeof</span> userDef <span class="token operator">===</span> <span class="token string">'function'</span> <span class="token operator">?</span> userDef <span class="token operator">:</span> userDef<span class="token punctuation">.</span>get
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isSSR<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// create internal watcher for the computed property.</span>
      watchers<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Watcher</span><span class="token punctuation">(</span>
        vm<span class="token punctuation">,</span>
        getter <span class="token operator">||</span> noop<span class="token punctuation">,</span>
        noop<span class="token punctuation">,</span>
        computedWatcherOptions
      <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// component-defined computed properties are already defined on the</span>
    <span class="token comment">// component prototype. We only need to define computed properties defined</span>
    <span class="token comment">// at instantiation here.</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>key <span class="token keyword">in</span> vm<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">defineComputed</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> key<span class="token punctuation">,</span> userDef<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token keyword">in</span> vm<span class="token punctuation">.</span>$data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">warn</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">The computed property &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; is already defined in data.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> vm<span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>vm<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>props <span class="token operator">&amp;&amp;</span> key <span class="token keyword">in</span> vm<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">warn</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">The computed property &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; is already defined as a prop.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> vm<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">createComputedGetter</span> <span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">computedGetter</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> watcher <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_computedWatchers <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_computedWatchers<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>watcher<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>watcher<span class="token punctuation">.</span>dirty<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 如果依赖的值没发生变化,就不会重新求值</span>
        watcher<span class="token punctuation">.</span><span class="token function">evaluate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>Dep<span class="token punctuation">.</span>target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        watcher<span class="token punctuation">.</span><span class="token function">depend</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> watcher<span class="token punctuation">.</span>value
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><h2 id="_6-computed和methods和watcher区别"><a href="#_6-computed和methods和watcher区别" class="header-anchor">#</a> 6.computed和methods和watcher区别</h2> <h3 id="computed"><a href="#computed" class="header-anchor">#</a> computed</h3> <ul><li><ol><li>简便逻辑操作，</li></ol></li> <li><ol start="2"><li>执行时，只执行直接调用的变量</li></ol></li> <li><ol start="3"><li>有缓存，如果数据不进行更新，则不会从新触发计算，从而节约性能</li></ol></li> <li><ol start="4"><li>不便于操作异步</li></ol></li> <li><ol start="5"><li>compouted默认不会先执行</li></ol></li> <li><ol start="6"><li>computed 是计算一个新的属性，并将该属性挂载到 vm（Vue 实例）上</li></ol></li> <li><ol start="7"><li>computed 本质是一个<strong>惰性求值的观察者</strong>，具有缓存性，只有当依赖变化后，第一次访问 computed 属性，才会计算新的值</li></ol></li> <li><ol start="8"><li>computed 适用一个数据被多个数据影响</li></ol></li></ul> <h3 id="methods"><a href="#methods" class="header-anchor">#</a> methods：</h3> <ul><li><ol><li>无缓存，每次都会重新计算</li></ol></li> <li><ol start="2"><li>视图更新时都会从新计算</li></ol></li></ul> <h3 id="watcher-一方改变-另一方跟着改变"><a href="#watcher-一方改变-另一方跟着改变" class="header-anchor">#</a> watcher(一方改变，另一方跟着改变)</h3> <ul><li><ol><li>代码复用性高</li></ol></li> <li><ol start="2"><li>便于处理异步</li></ol></li> <li><ol start="3"><li>高消耗性能的操作,限制我们执行该操作的频率，并在我们得到最终结果前，设置中间件</li></ol></li> <li><ol start="4"><li>混合使用</li></ol></li> <li><ol start="5"><li>watch会先执行</li></ol></li> <li><ol start="6"><li>watch 是监听已经存在且已挂载到 vm 上的数据，所以用 watch 同样可以监听 computed 计算属性的变化（其它还有 data、props）</li></ol></li> <li><ol start="7"><li>watch 则是当数据发生变化便会调用执行函数</li></ol></li> <li><ol start="8"><li>watch 适用一个数据影响多个数据</li></ol></li></ul> <h2 id="_7-生命周期"><a href="#_7-生命周期" class="header-anchor">#</a> 7.生命周期</h2> <h3 id="每个生命周期的用途"><a href="#每个生命周期的用途" class="header-anchor">#</a> 每个生命周期的用途</h3> <ul><li><code>beforeCreate</code> <ul><li>在实例初始化之后，数据观测(data observer) 之前被调用。</li></ul></li> <li><code>created</code> <ul><li>实例已创建完成后调用,在这一步，实例已经完成以下配置:数据观测(observer)，属性和方法的运算，watch/event时间回调，这里没有<code>$el</code></li></ul></li> <li><code>beforeMount</code> <ul><li>在挂在之前被调用，相关的render首次被调用</li></ul></li> <li><code>mounted</code> <ul><li><code>el</code>被创建的<code>vm.$el</code>所替代,并挂在到实例上去之后调用该钩子</li></ul></li> <li><code>beforeUpdate</code> <ul><li>数据更新时调用，发生在虚拟DOM重现渲染和打补丁之前</li></ul></li> <li><code>updated</code> <ul><li>由于数据更改导致虚拟DOM重新渲染和打补丁，在这之后会调用该钩子</li></ul></li> <li><code>beforeDestroy</code> <ul><li>实例销毁之前调用，在这一步，实例还可以完全使用</li></ul></li> <li><code>destroyed</code> <ul><li><code>Vue</code> 实例销毁后调用。调用后，<code>Vue</code> 实例指示的所有东西都会解绑定，所有的事件监听器会被移除，所有的子实例也会被销毁。 该钩子在服务器端渲染期间不被调用。</li></ul></li></ul> <h3 id="每个声明周期需要做的的事情"><a href="#每个声明周期需要做的的事情" class="header-anchor">#</a> 每个声明周期需要做的的事情</h3> <ul><li><code>created</code> <ul><li>实例已创建完成，可以进行一些数据和资源的请求</li></ul></li> <li><code>mounted</code> <ul><li>实例已创建完成,可以进行DOM操作</li></ul></li> <li><code>beforeUpdate</code> <ul><li>可以在这个钩子中进一步地更改状态，这不会触发附加的重渲染过程。</li></ul></li> <li><code>updated</code> <ul><li>可以执行依赖于 DOM 的操作。然而在大多数情况下，你应该避免在此期间更改状态，因为这可能会导致更新无限循环。 该钩子在服务器端渲染期间不被调用</li></ul></li> <li><code>destroyed</code> <ul><li>可以执行一些优化操作,清空定时器，解除绑定事件
<br> <br> <img src="/assets/img/life.d43d86dd.png"> <br> <br> <br> <br> <img src="/assets/img/life-data.2be8e829.png"></li></ul></li></ul> <h2 id="_8-v-show和v-if的区别"><a href="#_8-v-show和v-if的区别" class="header-anchor">#</a> 8.v-show和v-if的区别</h2> <ul><li><code>v-show</code> 只是切换当前<code>dom</code>的显示或者隐藏</li> <li><code>v-if</code> 如果条件不成立不会渲染当前指令所在节点的<code>dom</code>元素</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> VueTemplateCompiler <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'vue-template-compiler'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> r1 <span class="token operator">=</span> VueTemplateCompiler<span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;div v-if=&quot;true&quot;&gt;&lt;span v-for=&quot;i in 3&quot;&gt;hello&lt;/span&gt;&lt;/div&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/**
with(this) {
    return (true) ? _c('div', _l((3), function (i) {
        return _c('span', [_v(&quot;hello&quot;)])
    }), 0) : _e()
}
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> VueTemplateCompiler <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'vue-template-compiler'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> r2 <span class="token operator">=</span> VueTemplateCompiler<span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;div v-show=&quot;true&quot;&gt;&lt;/div&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/**
with(this) {
    return _c('div', {
        directives: [{
            name: &quot;show&quot;,
            rawName: &quot;v-show&quot;,
            value: (true),
            expression: &quot;true&quot;
        }]
    })
}
 */</span>

<span class="token comment">// v-show 操作的是样式  定义在platforms/web/runtime/directives/show.js</span>
<span class="token function">bind</span> <span class="token punctuation">(</span><span class="token parameter">el<span class="token operator">:</span> any<span class="token punctuation">,</span> <span class="token punctuation">{</span> value <span class="token punctuation">}</span><span class="token operator">:</span> VNodeDirective<span class="token punctuation">,</span> vnode<span class="token operator">:</span> VNodeWithData</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    vnode <span class="token operator">=</span> <span class="token function">locateNode</span><span class="token punctuation">(</span>vnode<span class="token punctuation">)</span>
    <span class="token keyword">const</span> transition <span class="token operator">=</span> vnode<span class="token punctuation">.</span>data <span class="token operator">&amp;&amp;</span> vnode<span class="token punctuation">.</span>data<span class="token punctuation">.</span>transition
    <span class="token keyword">const</span> originalDisplay <span class="token operator">=</span> el<span class="token punctuation">.</span>__vOriginalDisplay <span class="token operator">=</span>
      el<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">===</span> <span class="token string">'none'</span> <span class="token operator">?</span> <span class="token string">''</span> <span class="token operator">:</span> el<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display
    <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">&amp;&amp;</span> transition<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      vnode<span class="token punctuation">.</span>data<span class="token punctuation">.</span>show <span class="token operator">=</span> <span class="token boolean">true</span>
      <span class="token function">enter</span><span class="token punctuation">(</span>vnode<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        el<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> originalDisplay
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      el<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> value <span class="token operator">?</span> originalDisplay <span class="token operator">:</span> <span class="token string">'none'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h2 id="_9-v-for和v-if"><a href="#_9-v-for和v-if" class="header-anchor">#</a> 9.v-for和v-if</h2> <p><code>v-for</code>比<code>v-if</code>的优先级要高，如果连用，给每个属性都添加，造成资源浪费</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> VueTemplateCompiler <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'vue-template-compiler'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> r1 <span class="token operator">=</span> VueTemplateCompiler<span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;div v-if=&quot;false&quot; v-for=&quot;i in 3&quot;&gt;hello&lt;/div&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/**
with(this) {
    return _l((3), function (i) {
        return (false) ? _c('div', [_v(&quot;hello&quot;)]) : _e()
    })
}
*/</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>r1<span class="token punctuation">.</span>render<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="_10-组件中的-data为什么是一个函数"><a href="#_10-组件中的-data为什么是一个函数" class="header-anchor">#</a> 10.组件中的 <code>data</code>为什么是一个函数?</h2> <ul><li><ol><li>同一个组件被复用多次，会创建多个实例。</li></ol></li> <li><ol start="2"><li>这些实例用的是同一个构造函数，如果<code>data</code>是一个对象的话。那么所有组件都共享了同一个对象</li></ol></li> <li><ol start="3"><li>为了保证组件的数据独立性要求每个组件必须通过<code>data</code>函数返回一个对象作为组件的状态。</li></ol></li></ul> <h2 id="_11-vue组件如何通信"><a href="#_11-vue组件如何通信" class="header-anchor">#</a> 11.<code>Vue</code>组件如何通信?</h2> <ul><li><ol><li>父子间通信  父-&gt;子通过<code>props</code>、子-&gt; 父<code>$on、$emit</code></li></ol></li> <li><ol start="2"><li>获取父子组件实例的方式<code>$parent、$children</code></li></ol></li> <li><ol start="3"><li>在父组件中提供数据子组件进行消费 <code>Provide、inject</code></li></ol></li> <li><ol start="4"><li><code>Ref</code>获取实例的方式调用组件的属性或者方法</li></ol></li> <li><ol start="5"><li><code>Event Bus</code> 实现跨组件通信</li></ol></li> <li><ol start="6"><li><code>Vuex</code>状态管理实现通信</li></ol></li></ul> <h2 id="_12-vue中常见性能优化"><a href="#_12-vue中常见性能优化" class="header-anchor">#</a> 12.<code>Vue</code>中常见性能优化</h2> <h3 id="_1-编码优化"><a href="#_1-编码优化" class="header-anchor">#</a> 1.编码优化</h3> <ul><li><ol><li>不要将所有的数据都放在data中，data中的数据都会增加getter和setter，会收集对应的watcher</li></ol></li> <li><ol start="2"><li><code>vue</code> 在 v-for 时给每项元素绑定事件需要用事件代理</li></ol></li> <li><ol start="3"><li><code>SPA</code>页面采用keep-alive缓存组件</li></ol></li> <li><ol start="4"><li>拆分组件( 提高复用性、增加代码的可维护性,减少不必要的渲染  )</li></ol></li> <li><ol start="5"><li><code>v-if</code> 当值为false时内部指令不会执行,具有阻断功能，很多情况下使用v-if替代v-show</li></ol></li> <li><ol start="6"><li><code>key</code>保证唯一性 ( 默认<code>vue</code>会采用就地复用策略 )</li></ol></li> <li><ol start="7"><li><code>Object.freeze</code> 冻结数据</li></ol></li> <li><ol start="8"><li>合理使用路由懒加载、异步组件</li></ol></li> <li><ol start="9"><li>尽量采用runtime运行时版本</li></ol></li> <li><ol start="10"><li>数据持久化的问题 （防抖、节流）</li></ol></li></ul> <h3 id="_2-vue加载性能优化"><a href="#_2-vue加载性能优化" class="header-anchor">#</a> 2.<code>Vue</code>加载性能优化:</h3> <ol><li><p>第三方模块按需导入 (<code>babel-plugin-component</code>)</p></li> <li><p>滚动到可视区域动态加载  ( <a href="https://tangbc.github.io/vue-virtual-scroll-list" target="_blank">https://tangbc.github.io/vue-virtual-scroll-list</a> )</p></li> <li><p>图片懒加载  (<a target="_blank" href="https://github.com/hilongjw/vue-lazyload.git">https://github.com/hilongjw/vue-lazyload.git</a>)</p></li></ol> <h3 id="_3-用户体验"><a href="#_3-用户体验" class="header-anchor">#</a> 3.用户体验</h3> <ol><li><code>app-skeleton</code>骨架屏</li> <li><code>app-shell</code>app壳</li> <li><code>pwa</code></li></ol> <h3 id="_4-seo优化"><a href="#_4-seo优化" class="header-anchor">#</a> 4.<code>SEO</code>优化：</h3> <ol><li>预渲染插件 <code>prerender-spa-plugin</code></li> <li>服务端渲染<code>ssr</code></li></ol> <h3 id="_5-打包优化"><a href="#_5-打包优化" class="header-anchor">#</a> 5.打包优化:</h3> <ol><li>使用<code>cdn</code>的方式加载第三方模块</li> <li>多线程打包 <code>happypack</code></li> <li><code>splitChunks</code> 抽离公共文件</li> <li><code>sourceMap</code>生成</li></ol> <h3 id="_6-缓存-压缩"><a href="#_6-缓存-压缩" class="header-anchor">#</a> 6.缓存，压缩</h3> <ol><li>客户端缓存、服务端缓存</li> <li>服务端<code>gzip</code>压缩</li></ol> <h2 id="_13-vue3-0你知道有哪些改进"><a href="#_13-vue3-0你知道有哪些改进" class="header-anchor">#</a> 13.<code>Vue3.0</code>你知道有哪些改进?</h2> <ol><li><code>Vue3</code>采用了TS来编写</li> <li>支持 <code>Composition API</code></li> <li><code>Vue3</code>中响应式数据原理改成<code>proxy</code></li> <li><code>vdom</code>的对比算法更新，只更新<code>vdom</code>的绑定了动态数据的部分</li></ol> <h2 id="_14-router和route的区别"><a href="#_14-router和route的区别" class="header-anchor">#</a> 14.$router和route的区别</h2> <ol><li>$router是VueRouter的一个对象，通过Vue.use(VueRouter)和Vu构造函数得到一个router的实例对象，这个对象中是一个全局的对象，他包含了所有的路由，包含了许多关键的对象和属性。
<br> <br> <img src="/assets/img/router.1d16ee08.png"> <br></li></ol> <h3 id="以history对象来举例"><a href="#以history对象来举例" class="header-anchor">#</a> 以history对象来举例：</h3> <ul><li><p>$router.push({path:'home'})，本质是向history栈中添加一个路由，在我们看来是切换路由，但本质是在添加一个history记录</p></li> <li><p>$router.replace({path:'home'})，//替换路由，没有历史记录</p></li></ul> <ol start="2"><li>$route是一个跳转的路由对象，每一个路由都会有一个$route对象，是一个局部的对象，可以获取对应的name，path，params，query等
<br> <br> <img src="/assets/img/route.37457210.png"> <br></li></ol> <h3 id="这两者不同的结构可以看出两者的区别-他们的一些属性是不同的。"><a href="#这两者不同的结构可以看出两者的区别-他们的一些属性是不同的。" class="header-anchor">#</a> 这两者不同的结构可以看出两者的区别，他们的一些属性是不同的。</h3> <ul><li><ol><li>$route.path 字符串，等于当前路由对象的路径，会被解析为绝对路径，如/home/ews</li></ol></li> <li><ol start="2"><li>$route.params 对象，含路有种的动态片段和全匹配片段的键值对，不会拼接到路由的url后面</li></ol></li> <li><ol start="3"><li>$route.query 对象，包含路由中查询参数的键值对。会拼接到路由url后面</li></ol></li> <li><ol start="4"><li>$route.router 路由规则所属的路由器</li></ol></li> <li><ol start="5"><li>$route.matchd 数组，包含当前匹配的路径中所包含的所有片段所对象的配置参数对象</li></ol></li> <li><ol start="6"><li>$route.name 当前路由的名字，如果没有使用具体路径，则名字为空</li></ol></li></ul> <h2 id="_15-vue-use-执行原理"><a href="#_15-vue-use-执行原理" class="header-anchor">#</a> 15.Vue.use()执行原理</h2> <ul><li>Vue.use源码分析</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> toArray <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../util/index'</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">initUse</span> <span class="token punctuation">(</span><span class="token parameter">Vue<span class="token operator">:</span> GlobalAPI</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Vue<span class="token punctuation">.</span><span class="token function-variable function">use</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">plugin<span class="token operator">:</span> Function <span class="token operator">|</span> Object</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 限制了自定义组建的类型</span>
        <span class="token keyword">const</span> installedPlugins <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_installedPlugins <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_installedPlugins <span class="token operator">=</span>
        <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment">//保存注册组件的数组，不存在及创建</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>installedPlugins<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>plugin<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//判断该组件是否注册过，存在return Vue对象</span>
            <span class="token keyword">return</span> <span class="token keyword">this</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//调用`toArray`方法</span>
        <span class="token keyword">const</span> args <span class="token operator">=</span> <span class="token function">toArray</span><span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
        args<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
        <span class="token comment">//将Vue对象拼接到数组头部</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> plugin<span class="token punctuation">.</span>install <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//如果组件是对象，且提供install方法，调用install方法将参数数组传入，改变`this`指针为该组件</span>
            plugin<span class="token punctuation">.</span><span class="token function">install</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>plugin<span class="token punctuation">,</span> args<span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> plugin <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//如果传入组件是函数，这直接调用，但是此时的`this`指针只想为`null` </span>
            <span class="token function">plugin</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//在保存注册组件的数组中添加</span>
        installedPlugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>plugin<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><ul><li>toArray方法源码</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">toArray</span> <span class="token punctuation">(</span><span class="token parameter">list<span class="token operator">:</span> any<span class="token punctuation">,</span> start<span class="token operator">?</span><span class="token operator">:</span> number</span><span class="token punctuation">)</span><span class="token operator">:</span> Array<span class="token operator">&lt;</span>any<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  start <span class="token operator">=</span> start <span class="token operator">||</span> <span class="token number">0</span>
  <span class="token keyword">let</span> i <span class="token operator">=</span> list<span class="token punctuation">.</span>length <span class="token operator">-</span> start
<span class="token comment">//将存放参数的数组转为数组，并除去第一个参数（该组件）</span>
  <span class="token keyword">const</span> ret<span class="token operator">:</span> Array<span class="token operator">&lt;</span>any<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
<span class="token comment">//循环拿出数组</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ret<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> list<span class="token punctuation">[</span>i <span class="token operator">+</span> start<span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> ret
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="vue-use-是通过inituse进行初始化"><a href="#vue-use-是通过inituse进行初始化" class="header-anchor">#</a> Vue.use()是通过<code>initUse</code>进行初始化</h3> <ul><li>1.<code>vue.use（plugin, arguments）</code>接受一个参数<code>plugin</code>,这个<code>plugin</code>只接收两种类新型，<code>plugin(Function | Object)</code>,如果是对象，需要提供一个<code>install方法</code>,如果是是函数，会被当成<code>install</code>方法进行执行。</li> <li>2.方法检测了<code>installedPlugins</code>数组中是否已包含想要注册的组件，可知插件只被注册一次，二次注册是无效的</li> <li>3.调用<code>toArray</code>方法，将传入的参数转成数组</li> <li>4.把当前Vue对象this插入到转成数组的前面</li> <li>5.判断<code>plugin.install</code>是否是一个方法，如果是，则传入<code>plugin</code>及转化后的数组,如果<code>plugin</code>本身就是一个方法，则传入转化后的数组，然后执行这个方法,由此可知，Vue.use(插件),实际上就是调用插件的<code>install</code>方法，并且调用use的时候是可以传入参数的</li> <li>6.将注册后的插件推进<code>installedPlugins</code>，避免重复注册，返回当前实例，代码执行结束。</li></ul> <h2 id="_16-vue中key值的作用"><a href="#_16-vue中key值的作用" class="header-anchor">#</a> 16.Vue中key值的作用</h2> <ul><li><p>1.用于管理可复用的元素。因为Vue 会尽可能高效地渲染元素，通常会复用已有元素而不是从头开始渲染。这么做使 Vue 编译变得非常快</p></li> <li><p>2.Vue会尽可能的复用当前页面上所有的元素，如果元素没有独立的key值的话，如果我们只修改了元素的属性，那Vue会重复使用页面上的元素，只是给它修改一个属性</p></li> <li><p>3.在diff算法中，Vue使用 key 值来判断元素是否发生更改，以达到重复使用页面上所有可复用元素，特别是在列表渲染中，Vue通过key值来判断元素是否需要更新，如果元素只是更换位置的话，就不需要重新渲染，这也是为什么我们在列表渲染的时候为什么始终不建议使用元素的索引值来作为 key 值，因为索引值始终会发生改变，会增加Vue的渲染成本</p></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">6/1/2020, 10:33:51 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/interview/webpack/summary.html" class="prev">
        4.总结
      </a></span> <span class="next"><a href="/interview/vue/library.html">
        组件
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.ae35c946.js" defer></script><script src="/assets/js/4.7a9925ca.js" defer></script><script src="/assets/js/7.7df142e3.js" defer></script>
  </body>
</html>
